{
    "Version": "2012-10-17",
    "Id": "LockDown",
    "Statement": [
        {
            "Sid": "Restrict Outsiders",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::remote-location-test1",
                "arn:aws:s3:::remote-location-test1/*"
            ],
            "Condition": {
                "NotIpAddress": {
                    "aws:SourceIp": [
                        "3.214.108.144",
                        "172.31.56.143",
                        "107.15.230.166"
                    ]
                },
                "StringNotEquals": {
                    "aws:SourceVpce": "vpce-xxxxxxxxxxx"
                },
                "ArnNotEquals": {
                    "aws:SourceArn": "arn:aws:iam::736922127837:role/remotelocation-s3-access-ec2"
                }
            }
        },
        {
            "Sid": "Enforce Secure xport",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::remote-location-test1",
                "arn:aws:s3:::remote-location-test1/*"
            ],
            "Condition": {
                "Bool": {
                    "aws:SecureTransport": "False"
                }
            }
        },
        {
            "Sid": "Allow this account...",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::remote-location-test1",
                "arn:aws:s3:::remote-location-test1/*"
            ],
            "Condition": {
                "ArnEquals": {
                    "aws:PrincipalArn": [
                        "arn:aws:iam::736922127837:role/remotelocation-s3-access-ec2",
                        "arn:aws:iam::736922127837:root"
                    ]
                }
            }
        },
        {
            "Sid": "Enforce Secure xport",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::remote-location-test1",
                "arn:aws:s3:::remote-location-test1/*"
            ],
            "Condition": {
                "Bool": {
                    "aws:SecureTransport": "False"
                }
            }
        }
    ]
}
